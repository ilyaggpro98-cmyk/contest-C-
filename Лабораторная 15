#include <bits/stdc++.h>
using namespace std;
int main() {
    setlocale(LC_ALL,"Russian");
    int m, n;
    while (true) {
        cout << "Введите m (5 <= m <= 10): ";
        cin >> m;
        if (m >= 5 && m <= 10) break;
        cout << "m вне допустимого диапазона. Попробуйте снова.\n";
    }

    while (true) {
        cout << "Введите n (6 <= n <= 9): ";
        cin >> n;
        if (n >= 6 && n <= 9) break;
        cout << "n вне допустимого диапазона. Попробуйте снова.\n";
    }

    double a, b;
    cout << "Введите a (левый конец диапазона): ";
    cin >> a;
    cout << "Введите b (правый конец диапазона): ";
    cin >> b;

    if (a > b) {
        swap(a, b);
    }

    double *data = new double[m * n];
    double **mat = new double*[m];
    for (int i = 0; i < m; ++i) mat[i] = data + i * n;


    random_device rd;
    mt19937 gen(rd());
    uniform_real_distribution<double> dist(a, b);

    for (int i = 0; i < m; ++i)
        for (int j = 0; j < n; ++j)
            mat[i][j] = dist(gen);

    cout << "\nСформированная матрица (" << m << " x " << n << "):\n";
    cout << fixed << setprecision(3);
    for (int i = 0; i < m; ++i) {
        for (int j = 0; j < n; ++j) {
            cout << setw(8) << mat[i][j];
        }
        cout << '\n';
    }

    cout << "\nНомера столбцов, в которых не более трёх отрицательных элементов:\n";
    bool found = false;
    for (int j = 0; j < n; ++j) {
        int neg_cnt = 0;
        for (int i = 0; i < m; ++i) {
            if (mat[i][j] < 0.0) ++neg_cnt;
        }
        if (neg_cnt <= 3) {
            if (found) cout << ' ';
            cout << (j + 1);
            found = true;
        }
    }
    if (!found) cout << "Таких столбцов нет.";
    cout << "\n";

    delete[] mat;
    delete[] data;

    return 0;
}
